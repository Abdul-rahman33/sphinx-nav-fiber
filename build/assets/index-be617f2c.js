import{r as n,j as e,a4 as L,Y as E,a0 as j,Z as N,X as f}from"./index-f2d3050f.js";import{cz as O,cA as B,cB as I,u as v,ch as z,az as F,cj as P,aS as b,bO as D,cu as M,cC as R,ca as k}from"./index-884d3342.js";import{A as w,O as Y}from"./constants-c04b6c36.js";import"./index-6adf5ad4.js";import"./Select-90576b2a.js";const H=({selectedType:a,setSelectedType:i})=>{const[l,t]=n.useState([]);n.useEffect(()=>{(async()=>{try{const{data:d}=await O();t(d.edge_types)}catch(d){console.warn(d)}})()},[t]);const c=o=>({label:o,value:o}),p=o=>{i((o==null?void 0:o.value)||"")};return e.jsx(w,{onSelect:p,options:l.map(c),selectedValue:a?c(a):null})},U=({onSelect:a,selectedValue:i})=>{const[l,t]=n.useState([]),[c,p]=n.useState(!1),o=async s=>{const x={muted:"False",sort_by:I,search:s,skip:"0",limit:"1000"};p(!0);try{const h=await B(x.search);t(h.data)}catch{t([])}finally{p(!1)}},d=n.useMemo(()=>L.debounce(o,300),[]),r=s=>{if(!s){t([]);return}s.length>2&&d(s)},S=s=>{const x=s?l.find(h=>h.ref_id===s.value):null;a(x||null)},u=s=>({label:s.search_value,value:s.ref_id,type:s.node_type}),y=s=>s.map(u);return e.jsx(w,{handleInputChange:r,isLoading:c,onSelect:S,options:y(l)||Y,selectedValue:i?u(i):null})},V=({from:a,onSelect:i,selectedType:l,setSelectedType:t,selectedToNode:c})=>e.jsxs(f,{mb:20,children:[e.jsx(f,{align:"center",direction:"row",justify:"space-between",mb:18,children:e.jsx(f,{align:"center",direction:"row",children:e.jsx($,{children:"Add edge"})})}),e.jsxs(G,{mb:12,children:[e.jsxs(T,{children:[e.jsx("div",{className:"label",children:"From"}),e.jsx("div",{children:a})]}),e.jsxs(T,{children:[e.jsx("div",{className:"label",children:"Type"}),e.jsx(H,{selectedType:l,setSelectedType:t})]}),e.jsxs(T,{children:[e.jsx("div",{className:"label",children:"To"}),e.jsx(U,{onSelect:i,selectedValue:c})]})]})]}),$=E(N)`
  font-size: 22px;
  font-weight: 600;
  font-family: 'Barlow';
`,G=E(f).attrs({align:"stretch",direction:"row",justify:"flex-start"})`
  color: ${j.white};
  .label {
    margin-bottom: 8px;
    font-weight: 500;
    font-size: 14px;
    color: ${j.GRAY3};
  }
`,T=E(f)`
  flex: 1 1 100%;
  padding: 0 8px;
`,W=()=>{const{close:a}=v("editNodeName"),i=z({mode:"onChange"}),[l,t]=n.useState(!1),[c,p]=n.useState(""),[o,d]=n.useState(!1),[r,S]=n.useState(null),[u,y]=n.useState(),s=F();n.useEffect(()=>{(async()=>{if(s){d(!0);try{const{data:m}=await M({search:s==null?void 0:s.name}),_=m.find(A=>A.topic===s.name);y(_)}catch(m){console.log(m)}finally{d(!1)}}})()},[s]);const x=()=>{a()},h=async()=>{if(!(!r||!u)){t(!0);try{await R({from:u.ref_id,to:r==null?void 0:r.ref_id,relationship:c});const{ref_id:g}=u,{ref_id:m}=r;console.log(g,m),x()}catch(g){console.warn(g)}finally{t(!1)}}},C=l||!r||!c;return e.jsxs(P,{...i,children:[o?e.jsx(f,{align:"center",my:24,children:e.jsx(b,{color:j.BLUE_PRESS_STATE,size:24})}):e.jsx(V,{from:u?u.topic:"",onSelect:S,selectedToNode:r,selectedType:c,setSelectedType:p}),e.jsxs(D,{color:"secondary",disabled:C,onClick:h,size:"large",variant:"contained",children:["Confirm",l&&e.jsx(b,{color:j.BLUE_PRESS_STATE,size:10})]})]})},Q=()=>{const{close:a}=v("addEdgeToNode");return e.jsx(k,{id:"addEdgeToNode",kind:"large",onClose:a,preventOutsideClose:!0,children:e.jsx(W,{})})};export{Q as AddNodeEdgeModal};
